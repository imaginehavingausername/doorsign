<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Door Sign - Valentine's</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Keeping Nunito for that soft, friendly look -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@800;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Nunito', sans-serif;
            overflow: hidden;
            margin: 0;
            background-color: #ff758c; /* Fallback pink */
        }

        /* --- Romantic Background Layer --- */
        #bg-layer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            /* Pink, Salmon, and Soft Purple gradient */
            background: linear-gradient(-45deg, #ff9a9e, #fad0c4, #ffccd5, #c792ea);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            z-index: 1;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* --- Vignette Glow (Replaces Aurora) --- */
        /* Adds a soft dark rim to make white text pop in the center */
        .vignette {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, transparent 40%, rgba(150, 50, 80, 0.3) 100%);
            z-index: 2;
            pointer-events: none;
        }

        /* --- Main Screen Container --- */
        .screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            color: #ffffff;
            /* Softer, pinkish shadow for the text */
            text-shadow: 0 4px 10px rgba(180, 0, 50, 0.3);
            z-index: 20;
            pointer-events: none;
        }

        /* --- Effects Styling (Hearts) --- */
        .effect-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            z-index: 5;
            pointer-events: none;
        }

        /* Pure CSS Heart Shape */
        .heart {
            position: absolute;
            bottom: -50px; /* Start below screen */
            width: 20px;
            height: 20px;
            background: rgba(255, 255, 255, 0.6);
            transform: rotate(45deg);
            animation: floatUp linear infinite;
        }

        .heart::before,
        .heart::after {
            content: "";
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: inherit; /* Inherit color/opacity from parent */
            position: absolute;
        }

        .heart::before { left: -10px; }
        .heart::after { top: -10px; }

        @keyframes floatUp {
            0% {
                transform: translateY(0) rotate(45deg) scale(0.8);
                opacity: 0;
            }
            10% {
                opacity: 0.8;
            }
            100% {
                transform: translateY(-120vh) rotate(45deg) scale(1.2); /* Move way up */
                opacity: 0;
            }
        }

        #message-content {
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* --- Sleep Mode / Blackout --- */
        #blackout-layer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: black;
            z-index: 9999;
            display: none;
            cursor: none;
        }
    </style>
</head>
<body>

    <!-- Blackout Layer for Night Mode -->
    <div id="blackout-layer"></div>

    <!-- Background Layer -->
    <div id="bg-layer"></div>

    <!-- Vignette for text contrast -->
    <div class="vignette"></div>

    <!-- Container for visual effects (Hearts) -->
    <div id="effects-container" class="effect-container"></div>

    <!-- Screen for the main message -->
    <div id="message-screen" class="screen">
        <div id="message-content">
            <!-- Loading message content... -->
        </div>
    </div>

    <script>
        const messageContent = document.getElementById('message-content');
        const effectsContainer = document.getElementById('effects-container');
        const blackoutLayer = document.getElementById('blackout-layer');
        
        async function loadMessage() {
            try {
                // Cache busting to ensure we get new messages immediately
                const response = await fetch('message.html?t=' + new Date().getTime());
                if (!response.ok) throw new Error('Network response was not ok');
                const html = await response.text();
                if (messageContent.innerHTML !== html) {
                    messageContent.innerHTML = html;
                }
            } catch (error) {
                console.error('Failed to fetch message:', error);
            }
        }

        function createHeart() {
            const heart = document.createElement('div');
            heart.classList.add('heart');
            
            // Randomize Size
            const sizeBase = Math.random() * 10 + 10; // 10px to 20px
            heart.style.width = sizeBase + 'px';
            heart.style.height = sizeBase + 'px';
            
            // Adjust pseudo-elements to match size
            // (Note: complex CSS var manipulation is cleaner, but this is simple JS logic)
            // For simplicity in this specific "Pure CSS Heart" hack, we scale via transform in animation
            // or we can just leave the base css size and rely on opacity/randomness.
            // Let's rely on standard size but random left/speed.

            heart.style.left = Math.random() * 100 + 'vw';
            
            // Randomize Color (White vs Soft Pink)
            const isPink = Math.random() > 0.7;
            heart.style.background = isPink ? 'rgba(255, 182, 193, 0.6)' : 'rgba(255, 255, 255, 0.4)';

            const duration = Math.random() * 5 + 6; // 6 to 11 seconds (slower float)
            heart.style.animationDuration = duration + 's';
            
            // Add a little delay so they don't all start at bottom 0 instantly if spammed
            heart.style.animationDelay = '-' + Math.random() * 5 + 's';

            effectsContainer.appendChild(heart);
            setTimeout(() => { heart.remove(); }, duration * 1000);
        }

        // --- Night Mode / Timer Logic ---
        function checkTime() {
            const now = new Date();
            const hours = now.getHours();
            const minutes = now.getMinutes();
            
            // 10:45 PM is 22:45
            // 6:00 AM is 6:00
            
            const currentTotalMinutes = hours * 60 + minutes;
            const startBlackoutMinutes = 22 * 60 + 45; // 1365
            const endBlackoutMinutes = 6 * 60;         // 360

            if (currentTotalMinutes >= startBlackoutMinutes || currentTotalMinutes < endBlackoutMinutes) {
                if (blackoutLayer.style.display !== 'block') {
                    blackoutLayer.style.display = 'block';
                }
            } else {
                if (blackoutLayer.style.display !== 'none') {
                    blackoutLayer.style.display = 'none';
                }
            }
        }

        // Initial Calls
        loadMessage();
        checkTime();

        // Intervals
        setInterval(loadMessage, 5000); 
        setInterval(createHeart, 400); // Create hearts slightly less frequently than snow
        setInterval(checkTime, 60000); // Check time every minute

    </script>
</body>
</html>
