<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Door Sign</title>
  <style id="dynamic-style">
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background: black;
      color: limegreen;
      font-size: 3em;
      font-family: monospace;
      transition: all 0.5s ease;
    }
  </style>
</head>
<body>
  <div id="message">Loading...</div>

  <script>
    async function loadMessage() {
      try {
        let res = await fetch("message.txt?time=" + Date.now(), {cache: "no-store"});
        let text = await res.text();
        document.getElementById("message").innerText = text;
      } catch(e) {
        console.error("Message fetch failed:", e);
      }
    }

    async function loadStyle() {
      try {
        let res = await fetch("style.json?time=" + Date.now(), {cache: "no-store"});
        let json = await res.json();
        let css = `
          body {
            background: ${json.background || "black"};
            color: ${json.color || "limegreen"};
            font-size: ${json.fontSize || "3em"};
            font-family: ${json.fontFamily || "monospace"};
            transition: all 0.5s ease;
          }
          #message {
            animation: ${json.animation || "none"};
          }
          @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
          }
        `;
        document.getElementById("dynamic-style").textContent = css;
      } catch(e) {
        console.error("Style fetch failed:", e);
      }
    }

    // Load immediately, then refresh every 10s
    loadMessage();
    loadStyle();
    setInterval(loadMessage, 10000);
    setInterval(loadStyle, 10000);
  </script>
</body>
</html>
