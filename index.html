<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Door Sign</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Switched to Nunito (Rounded, 800/900 weight) for a soft, snowy, bold look -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@800;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Nunito', sans-serif; /* Updated Font */
            overflow: hidden;
            margin: 0;
            background-color: #74b9ff;
        }

        /* --- Dedicated Background Layer --- */
        /* Made colors slightly more distinct so movement is noticeable */
        #bg-layer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: radial-gradient(circle at center, #89C4F4 0%, #B0E0E6 50%, #5D9CEC 100%);
            background-size: 300% 300%;
            animation: radialShift 20s ease-in-out infinite alternate;
            z-index: 1;
        }

        @keyframes radialShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 70%; }
            100% { background-position: 0% 50%; }
        }

        /* --- Aurora Borealis Effect --- */
        .aurora-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 45vh; /* Top half-ish */
            overflow: hidden;
            z-index: 2;
            pointer-events: none;
            opacity: 0.8;
            mask-image: linear-gradient(to bottom, black 0%, transparent 100%);
            -webkit-mask-image: linear-gradient(to bottom, black 0%, transparent 100%);
        }

        .aurora {
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: repeating-linear-gradient(
                90deg,
                rgba(86, 255, 180, 0) 0%,
                rgba(86, 255, 180, 0.2) 15%,
                rgba(150, 50, 255, 0.2) 30%,
                rgba(86, 255, 180, 0) 45%
            );
            background-size: 200% 100%;
            filter: blur(20px);
            animation: auroraMove 15s linear infinite alternate;
            transform: skewY(10deg);
            mix-blend-mode: screen;
        }

        .aurora:nth-child(2) {
            top: -40%;
            animation-duration: 22s;
            animation-direction: alternate-reverse;
            background: repeating-linear-gradient(
                90deg,
                rgba(0, 255, 130, 0) 0%,
                rgba(0, 255, 130, 0.15) 20%,
                rgba(200, 100, 255, 0.15) 40%,
                rgba(0, 255, 130, 0) 60%
            );
            filter: blur(30px);
        }

        @keyframes auroraMove {
            0% { transform: translateX(-10%) skewY(5deg); }
            100% { transform: translateX(10%) skewY(-5deg); }
        }

        /* --- Main Screen Container --- */
        .screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            color: #ffffff;
            text-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            z-index: 20; /* Text on top */
            pointer-events: none;
        }

        /* --- Effects Styling --- */
        .effect-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            z-index: 5; /* Between BG and Text */
            pointer-events: none;
        }

        .snowflake {
            position: absolute;
            top: -20px;
            background-color: white;
            border-radius: 50%;
            opacity: 0.8;
            animation: fall linear infinite;
            box-shadow: 0 0 5px rgba(255, 255, 255, 0.8);
        }

        @keyframes fall {
            0% { transform: translateY(-10vh) translateX(0px); }
            100% { transform: translateY(110vh) translateX(25px); }
        }

        #message-content {
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* --- Sleep Mode / Blackout --- */
        #blackout-layer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: black;
            z-index: 9999; /* On top of absolutely everything */
            display: none; /* Hidden by default */
            cursor: none;
        }
    </style>
</head>
<body>

    <!-- Blackout Layer for Night Mode -->
    <div id="blackout-layer"></div>

    <!-- Background Layer -->
    <div id="bg-layer"></div>

    <!-- Aurora Borealis Layer -->
    <div class="aurora-container">
        <div class="aurora"></div>
        <div class="aurora"></div>
    </div>

    <!-- Container for visual effects (Snow) -->
    <div id="effects-container" class="effect-container"></div>

    <!-- Screen for the main message -->
    <div id="message-screen" class="screen">
        <div id="message-content">
            <!-- Loading message content... -->
        </div>
    </div>

    <script>
        const messageContent = document.getElementById('message-content');
        const effectsContainer = document.getElementById('effects-container');
        const blackoutLayer = document.getElementById('blackout-layer');
        
        async function loadMessage() {
            try {
                // Cache busting to ensure we get new messages immediately
                const response = await fetch('message.html?t=' + new Date().getTime());
                if (!response.ok) throw new Error('Network response was not ok');
                const html = await response.text();
                if (messageContent.innerHTML !== html) {
                    messageContent.innerHTML = html;
                }
            } catch (error) {
                console.error('Failed to fetch message:', error);
            }
        }

        // --- Removed Balloon Logic ---

        function createSnowflake() {
            const snowflake = document.createElement('div');
            snowflake.classList.add('snowflake');
            
            const size = Math.random() * 6 + 4; // Size between 4px and 10px
            snowflake.style.width = size + 'px';
            snowflake.style.height = size + 'px';
            snowflake.style.left = Math.random() * 100 + 'vw';
            snowflake.style.opacity = Math.random() * 0.6 + 0.4;
            
            const duration = Math.random() * 3 + 3; 
            snowflake.style.animationDuration = duration + 's';

            effectsContainer.appendChild(snowflake);
            setTimeout(() => { snowflake.remove(); }, duration * 1000);
        }

        // --- Night Mode / Timer Logic ---
        function checkTime() {
            const now = new Date();
            const hours = now.getHours();
            const minutes = now.getMinutes();
            
            // 10:45 PM is 22:45
            // 6:00 AM is 6:00
            
            const currentTotalMinutes = hours * 60 + minutes;
            const startBlackoutMinutes = 22 * 60 + 45; // 1365
            const endBlackoutMinutes = 6 * 60;         // 360

            // Logic: Blackout if Current time is GREATER than Start OR LESS than End
            // e.g., 23:00 (1380 > 1365) -> Blackout
            // e.g., 01:00 (60 < 360) -> Blackout
            // e.g., 12:00 (720 !> 1365 && 720 !< 360) -> Visible

            if (currentTotalMinutes >= startBlackoutMinutes || currentTotalMinutes < endBlackoutMinutes) {
                if (blackoutLayer.style.display !== 'block') {
                    blackoutLayer.style.display = 'block';
                }
            } else {
                if (blackoutLayer.style.display !== 'none') {
                    blackoutLayer.style.display = 'none';
                }
            }
        }

        // Initial Calls
        loadMessage();
        checkTime();

        // Intervals
        setInterval(loadMessage, 5000); 
        setInterval(createSnowflake, 150);
        setInterval(checkTime, 60000); // Check time every minute

    </script>
</body>
</html>
