<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>New Year Sign</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Fredoka One for the bubbly shape -->
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Fredoka One', cursive;
            overflow: hidden;
            margin: 0;
            background: #000;
            touch-action: none; /* Prevent scroll on mobile */
        }

        /* --- 1. Background & Atmosphere --- */
        .global-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: -1;
            /* Deep, rich Christmas gradient */
            background: radial-gradient(circle at center, #8f1729 0%, #174227 60%, #05140b 100%);
            background-size: 200% 200%;
            animation: christmasGlow 15s ease-in-out infinite alternate;
            transition: opacity 2s ease;
        }

        @keyframes christmasGlow {
            0% { background-position: 0% 50%; filter: brightness(0.9); }
            50% { background-position: 100% 50%; filter: brightness(1.2); }
            100% { background-position: 0% 50%; filter: brightness(0.9); }
        }

        /* --- 2. Snow System --- */
        .snowflake {
            position: absolute;
            background-color: white;
            border-radius: 50%;
            pointer-events: none;
            animation: fall linear infinite;
        }

        @keyframes fall {
            0% { transform: translateY(-10vh) translateX(0); }
            100% { transform: translateY(110vh) translateX(20px); }
        }

        /* --- 3. Music Notes System --- */
        .music-note {
            position: absolute;
            color: #d4af37; /* Gold */
            pointer-events: none;
            animation: floatUpNote linear infinite;
            z-index: 5;
            font-family: sans-serif; /* Standard font for symbols */
        }

        @keyframes floatUpNote {
            0% { transform: translateY(110vh) translateX(0) rotate(0deg); opacity: 0; }
            10% { opacity: 0.8; }
            90% { opacity: 0.8; }
            100% { transform: translateY(-10vh) translateX(50px) rotate(45deg); opacity: 0; }
        }

        /* --- 4. Mylar Balloon Typography --- */
        .balloon-word {
            display: flex;
            justify-content: center;
            gap: 0.1rem; 
            perspective: 1000px;
            margin-bottom: 0.5rem; /* Space between lines */
            flex-wrap: nowrap;
        }

        .balloon-char {
            display: inline-block;
            position: relative;
            color: #d4af37; /* Fallback */
            
            /* The Mylar Material Look */
            background-image: linear-gradient(135deg, 
                #ffd700 0%, 
                #fff8db 20%, 
                #d4af37 40%, 
                #b8860b 60%, 
                #fff8db 80%, 
                #d4af37 100%
            );
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            
            /* 3D Depth & Shine */
            filter: drop-shadow(0px 4px 6px rgba(0,0,0,0.6));
            
            /* Initial State for Animation */
            transform-origin: center bottom;
            will-change: transform;
        }

        /* Red Variant */
        .balloon-red .balloon-char {
            background-image: linear-gradient(135deg, 
                #ff4d4d 0%, 
                #ffcccc 20%, 
                #cc0000 40%, 
                #990000 60%, 
                #ffcccc 80%, 
                #cc0000 100%
            );
        }

        /* Floating Animation (Bobbing) */
        @keyframes floatBalloon {
            0% { transform: translateY(0) rotate(-3deg) scale(1); }
            50% { transform: translateY(-15px) rotate(3deg) scale(1.02); }
            100% { transform: translateY(0) rotate(-3deg) scale(1); }
        }

        /* Pop-in Animation (Inflation) */
        @keyframes inflate {
            0% { transform: scale(0); opacity: 0; }
            60% { transform: scale(1.2); opacity: 1; }
            80% { transform: scale(0.9); }
            100% { transform: scale(1); opacity: 1; }
        }

        /* --- 5. Sleep Mode (Blackout) --- */
        #blackout-curtain {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: black;
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: opacity 2s ease;
        }
        .sleeping #blackout-curtain {
            opacity: 1;
            pointer-events: all;
        }

        /* Container transition for smooth vertical shifts if needed */
        #message-container {
            transition: all 1s ease-in-out;
        }
    </style>
</head>
<body class="bg-black text-white h-screen w-screen overflow-hidden flex items-center justify-center">
    
    <!-- Background Elements -->
    <div class="global-bg" id="bg-layer"></div>
    
    <!-- Snow Layer 1: Behind Text (Z-Index 0) -->
    <div id="snow-back" class="fixed top-0 left-0 w-full h-full pointer-events-none z-0"></div>

    <!-- Music Notes Layer (Z-Index 5) -->
    <div id="music-notes-layer" class="fixed top-0 left-0 w-full h-full pointer-events-none z-5"></div>
    
    <!-- Sleep Mode Overlay -->
    <div id="blackout-curtain"></div>

    <!-- Main Content (Z-Index 10) -->
    <main class="relative z-10 w-full max-w-lg mx-auto p-4">
        <!-- Message Container: Flex column centered. As items add, they push up/center automatically -->
        <div id="message-container" class="flex flex-col items-center justify-center min-h-[50vh]">
            <!-- Dynamic Content Injected Here -->
        </div>
    </main>

    <!-- Snow Layer 2: In Front of Text (Z-Index 20) -->
    <div id="snow-front" class="fixed top-0 left-0 w-full h-full pointer-events-none z-20"></div>

    <script>
        // --- Configuration ---
        const CONFIG = {
            sequenceDelay: 2000,    // Time between lines appearing
            cycleResetTime: 8000,   // Time after full message before reset
            sleepTime: 22.5,        // 10:30 PM
            wakeTime: 6.0,          // 6:00 AM
            debug: false
        };

        const MESSAGE_LINES = [
            { text: "We wish you", type: "gold", size: "text-[10vw] md:text-5xl" },
            { text: "a Merry Christmas", type: "red", size: "text-[12vw] md:text-7xl" },
            { text: "and a Happy", type: "gold", size: "text-[10vw] md:text-5xl" },
            { text: "New Year!", type: "red", size: "text-[15vw] md:text-8xl" }
        ];

        let sequenceTimeout; // To track/cancel timeouts during sleep

        // --- 1. Typography & Animation ---
        function createBalloonLine(textObj) {
            const lineContainer = document.createElement('div');
            lineContainer.className = `balloon-word ${textObj.type === 'red' ? 'balloon-red' : ''} ${textObj.size} leading-none`;
            
            [...textObj.text].forEach((char, index) => {
                // Handle spaces to ensure words don't collapse too much, though flex gap handles most
                if (char === ' ') {
                    const space = document.createElement('span');
                    space.style.width = '0.3em';
                    lineContainer.appendChild(space);
                    return;
                }

                const span = document.createElement('span');
                span.textContent = char;
                span.className = 'balloon-char';
                
                // 1. Permanent Float Animation
                const floatDelay = Math.random() * 2;
                const floatDuration = 3 + Math.random() * 2;
                
                // 2. Entrance Pop-in Animation
                // Stagger inflation by index for wave effect
                const inflateDelay = index * 0.05; 
                
                // Combine: Inflate once, then Float forever
                span.style.animation = `
                    inflate 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) ${inflateDelay}s forwards, 
                    floatBalloon ${floatDuration}s ease-in-out ${inflateDelay + 0.8}s infinite alternate
                `;
                
                lineContainer.appendChild(span);
            });

            return lineContainer;
        }

        async function runMessageSequence() {
            const container = document.getElementById('message-container');
            
            // Loop forever
            while (true) {
                // If sleeping, wait and check again
                if (document.body.classList.contains('sleeping')) {
                    await new Promise(r => setTimeout(r, 2000));
                    continue;
                }

                // 1. Clear previous
                container.innerHTML = '';
                
                // 2. Add lines one by one
                for (const lineConfig of MESSAGE_LINES) {
                    if (document.body.classList.contains('sleeping')) break;

                    const lineEl = createBalloonLine(lineConfig);
                    container.appendChild(lineEl);
                    
                    // Wait for next line
                    await new Promise(r => setTimeout(r, CONFIG.sequenceDelay));
                }

                // 3. Wait while full message is displayed
                await new Promise(r => setTimeout(r, CONFIG.cycleResetTime));
                
                // 4. Fade out effect (optional, or just clear)
                container.style.opacity = '0';
                await new Promise(r => setTimeout(r, 1000));
                container.innerHTML = '';
                container.style.opacity = '1';
            }
        }

        // --- 2. Particle Systems (Snow & Music) ---
        function createSnowLayer(containerId, count, minSize, maxSize, minOpacity, maxOpacity) {
            const container = document.getElementById(containerId);
            for (let i = 0; i < count; i++) {
                const flake = document.createElement('div');
                flake.classList.add('snowflake');
                flake.style.left = Math.random() * 100 + 'vw';
                flake.style.top = '-10vh';
                const size = Math.random() * (maxSize - minSize) + minSize;
                flake.style.width = size + 'vw';
                flake.style.height = size + 'vw';
                flake.style.opacity = Math.random() * (maxOpacity - minOpacity) + minOpacity;
                const duration = Math.random() * 5 + 10;
                flake.style.animationDuration = duration + 's';
                flake.style.animationDelay = (Math.random() * duration) * -1 + 's';
                container.appendChild(flake);
            }
        }

        function createMusicNotes() {
            const container = document.getElementById('music-notes-layer');
            const symbols = ['♪', '♫', '♩'];
            const noteCount = 9; // Reduced from 12

            for (let i = 0; i < noteCount; i++) {
                const note = document.createElement('div');
                note.classList.add('music-note');
                note.textContent = symbols[Math.floor(Math.random() * symbols.length)];
                
                // Position: Mostly on the sides (0-20% or 80-100%)
                const isLeft = Math.random() > 0.5;
                const xPos = isLeft ? Math.random() * 20 : 80 + Math.random() * 20;
                
                note.style.left = xPos + 'vw';
                
                // Size variation
                const size = 1.5 + Math.random() * 2; // 1.5rem to 3.5rem
                note.style.fontSize = size + 'rem';

                // Animation physics
                const duration = 6 + Math.random() * 6; // 6-12s float up
                note.style.animationDuration = duration + 's';
                note.style.animationDelay = (Math.random() * duration) * -1 + 's';
                
                container.appendChild(note);
            }
        }

        function initEnvironment() {
            createSnowLayer('snow-back', 30, 0.2, 0.5, 0.1, 0.4);
            createSnowLayer('snow-front', 20, 0.6, 1.2, 0.5, 0.9);
            createMusicNotes();
        }

        // --- 3. Sleep Timer Logic ---
        function checkTime() {
            const now = new Date();
            const currentHour = now.getHours() + (now.getMinutes() / 60);
            
            const isSleepTime = currentHour >= CONFIG.sleepTime || currentHour < CONFIG.wakeTime;

            if (isSleepTime && !CONFIG.debug) {
                if (!document.body.classList.contains('sleeping')) {
                    console.log("Goodnight! Entering sleep mode.");
                    document.body.classList.add('sleeping');
                }
            } else {
                if (document.body.classList.contains('sleeping')) {
                    console.log("Good morning! Waking up.");
                    document.body.classList.remove('sleeping');
                }
            }
        }

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            initEnvironment();
            runMessageSequence();
            
            // Start Sleep Timer
            checkTime();
            setInterval(checkTime, 60000);
        });

    </script>
</body>
</html>
