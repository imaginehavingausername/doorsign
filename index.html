<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Door Sign</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden; /* This is key to hiding the sliding content */
            margin: 0;
            background: #000; /* Fallback */
        }

        /* --- Background Container --- 
           Moved background here so it stays fixed while content slides, 
           or you can put it on body. Keeping it fixed looks better for the 
           "snow moves, background stays" depth effect, but based on your 
           request for snow moving WITH screen, we'll keep the background 
           on the body so the atmosphere feels global. 
        */
        .global-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: -1;
            background: radial-gradient(ellipse at bottom, #C41E3A 0%, #165B33 50%, #000000 100%);
            background-size: 200% 200%;
            animation: christmasGlow 15s ease-in-out infinite alternate;
        }

        @keyframes christmasGlow {
          0% { background-position: 0% 80%; }
          50% { background-position: 100% 20%; }
          100% { background-position: 0% 80%; }
        }

        /* --- Wrapper for the sliding animation --- */
        #slider-wrapper {
            position: relative;
            width: 100vw;
            height: 200vh; /* 2x viewport height to hold both screens */
            /* Animation: 10s total duration
               - 4.5s hold on screen 1
               - 0.5s slide
               - 4.5s hold on screen 2
               - 0.5s slide back
            */
            animation: slideScreens 10s cubic-bezier(0.76, 0, 0.24, 1) infinite;
            will-change: transform, filter; /* optimize performance */
        }

        /* --- Keyframes with Motion Blur --- */
        @keyframes slideScreens {
            0% {
                transform: translateY(0);
                filter: blur(0px);
            }
            45% {
                transform: translateY(0);
                filter: blur(0px);
            }
            /* Start movement & blur */
            46% {
                filter: blur(8px); /* Motion blur effect */
            }
            49% {
                filter: blur(8px); /* Maintain blur during fast move */
            }
            50% {
                transform: translateY(-100vh);
                filter: blur(0px); /* Snaps back to sharp */
            }
            95% {
                transform: translateY(-100vh);
                filter: blur(0px);
            }
            /* Start return movement & blur */
            96% {
                filter: blur(8px);
            }
            99% {
                filter: blur(8px);
            }
            100% {
                transform: translateY(0);
                filter: blur(0px);
            }
        }

        /* --- Screen containers --- */
        .screen {
            position: absolute;
            left: 0;
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            color: #f0f0f0;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.7);
            z-index: 10; /* Text above background */
        }

        #message-screen { top: 0; }
        #christmas-screen { top: 100vh; }
        
        .content-hidden { display: none; }

        /* --- Snowflakes --- */
        .snowflake {
            position: absolute;
            background-color: white;
            border-radius: 50%;
            opacity: 0.8;
            pointer-events: none;
            z-index: 5; /* Behind text (10) but above bg */
            animation: fall linear infinite;
        }

        @keyframes fall {
            0% { transform: translateY(0); }
            100% { transform: translateY(200vh); } /* Fall entire height of slider */
        }

    </style>
</head>
<body class="bg-black">
    
    <!-- Background is fixed so it doesn't slide, creating depth against the sliding content -->
    <div class="global-bg"></div>

    <div id="content-wrapper">
        <div id="slider-wrapper">
            <!-- Snow will be injected here by JS so it moves WITH the slider -->

            <!-- Screen 1: Message -->
            <div id="message-screen" class="screen">
                <!-- Loading message content... -->
            </div>

            <!-- Screen 2: Christmas Countdown -->
            <div id="christmas-screen" class="screen">
                <div class="text-center">
                    <div class="text-[5vw] md:text-[4vw] font-bold uppercase tracking-wider opacity-90 mb-4">Christmas In</div>
                    <div class="flex justify-center gap-4 md:gap-8">
                        <!-- Countdown Blocks -->
                        <div class="flex flex-col items-center bg-black/20 p-2 md:p-4 rounded-lg min-w-[18vw] md:min-w-[120px] border border-white/10 backdrop-blur-sm">
                            <span id="days" class="text-[12vw] md:text-8xl font-bold leading-none">0</span>
                            <span class="text-[2.5vw] md:text-xl uppercase opacity-70 font-normal">Days</span>
                        </div>
                        <div class="flex flex-col items-center bg-black/20 p-2 md:p-4 rounded-lg min-w-[18vw] md:min-w-[120px] border border-white/10 backdrop-blur-sm">
                            <span id="hours" class="text-[12vw] md:text-8xl font-bold leading-none">0</span>
                            <span class="text-[2.5vw] md:text-xl uppercase opacity-70 font-normal">Hours</span>
                        </div>
                        <div class="flex flex-col items-center bg-black/20 p-2 md:p-4 rounded-lg min-w-[18vw] md:min-w-[120px] border border-white/10 backdrop-blur-sm">
                            <span id="minutes" class="text-[12vw] md:text-8xl font-bold leading-none">0</span>
                            <span class="text-[2.5vw] md:text-xl uppercase opacity-70 font-normal">Mins</span>
                        </div>
                        <div class="flex flex-col items-center bg-black/20 p-2 md:p-4 rounded-lg min-w-[18vw] md:min-w-[120px] border border-white/10 backdrop-blur-sm">
                            <span id="seconds" class="text-[12vw] md:text-8xl font-bold leading-none">0</span>
                            <span class="text-[2.5vw] md:text-xl uppercase opacity-70 font-normal">Secs</span>
                        </div>
                    </div>
                </div>
            </div>

        </div> 
    </div>

    <script>
        const contentWrapper = document.getElementById('content-wrapper');
        const messageScreen = document.getElementById('message-screen');
        const sliderWrapper = document.getElementById('slider-wrapper');
        let countdownInterval;
        let wakeUpFlag = true; 

        // --- Snow Generation ---
        function createSnow() {
            const snowflakeCount = 80; // Adjust for density
            
            for (let i = 0; i < snowflakeCount; i++) {
                const flake = document.createElement('div');
                flake.classList.add('snowflake');
                
                // Randomize horizontal position
                flake.style.left = Math.random() * 100 + 'vw';
                
                // Randomize vertical start position so they don't all start at the top
                // We spread them across the entire 200vh height initially
                const startTop = Math.random() * 200; 
                flake.style.top = startTop + 'vh';
                
                // Randomize size
                const size = Math.random() * 0.6 + 0.2; // 0.2vw to 0.8vw
                flake.style.width = size + 'vw';
                flake.style.height = size + 'vw';
                
                // Randomize animation duration (speed)
                const duration = Math.random() * 5 + 5; // 5s to 10s
                flake.style.animationDuration = duration + 's';
                
                // Randomize delay so the loop isn't synchronized
                flake.style.animationDelay = (Math.random() * 5) * -1 + 's';
                
                // Randomize opacity for depth
                flake.style.opacity = Math.random() * 0.5 + 0.3;

                // Reset logic: When animation ends (visually loops), we might want to ensure smooth looping.
                // Since we use infinite linear animation, we just need to make sure the start/end match nicely.
                // However, standard CSS 'fall' just resets to 0. To make it seamless, 
                // we set the animation to run.
                
                sliderWrapper.appendChild(flake);
            }
        }

        // --- Message Loader ---
        async function loadMessage() {
            try {
                const response = await fetch('message.html?t=' + new Date().getTime());
                if (!response.ok) throw new Error('Network response was not ok');
                const html = await response.text();
                if (!wakeUpFlag) { 
                    messageScreen.innerHTML = html;
                }
            } catch (error) {
                console.error('Failed to fetch message:', error);
                // Keep old message or show error if empty
                if(messageScreen.innerHTML.trim() === "") {
                     messageScreen.innerHTML = `<div class="text-center">Loading...</div>`;
                }
            }
        }

        // --- Countdown Logic ---
        function startCountdown() {
            if (countdownInterval) clearInterval(countdownInterval);

            const daysEl = document.getElementById('days');
            const hoursEl = document.getElementById('hours');
            const minutesEl = document.getElementById('minutes');
            const secondsEl = document.getElementById('seconds');

            const update = () => {
                const now = new Date();
                let christmasDate = new Date(`December 25, ${now.getFullYear()} 00:00:00`);
                if (now > christmasDate) {
                    christmasDate = new Date(`December 25, ${now.getFullYear() + 1} 00:00:00`);
                }
                const totalSeconds = Math.floor((christmasDate - now) / 1000);

                daysEl.innerText = Math.floor(totalSeconds / 86400);
                hoursEl.innerText = String(Math.floor((totalSeconds % 86400) / 3600)).padStart(2, '0');
                minutesEl.innerText = String(Math.floor((totalSeconds % 3600) / 60)).padStart(2, '0');
                secondsEl.innerText = String(totalSeconds % 60).padStart(2, '0');
            };

            update();
            countdownInterval = setInterval(update, 1000);
        }

        // --- Sleep Cycle Manager ---
        function manageSleepCycle() {
            const now = new Date();
            const hour = now.getHours();
            const minute = now.getMinutes();

            // Screen is off between 10:45 PM and 6:00 AM
            const isSleepTime = (hour > 22 || (hour === 22 && minute >= 45)) || (hour < 6);

            if (isSleepTime) {
                if (!contentWrapper.classList.contains('content-hidden')) {
                    contentWrapper.classList.add('content-hidden');
                }
                wakeUpFlag = true;
            } else {
                if (contentWrapper.classList.contains('content-hidden')) {
                    contentWrapper.classList.remove('content-hidden');
                }
                if (wakeUpFlag) {
                    console.log("Good morning!");
                    messageScreen.innerHTML = `
                    <div class="flex flex-col text-center max-w-[90%]">
                        <div class="text-[10vw] font-extrabold uppercase text-gray-100 leading-tight">asleep</div>
                    </div>`;
                    wakeUpFlag = false; 
                }
            }
        }

        // --- Init ---
        createSnow(); // Let it snow!
        loadMessage();
        setInterval(loadMessage, 10000);
        startCountdown();
        manageSleepCycle();
        setInterval(manageSleepCycle, 60000);
    </script>
</body>
</html>
