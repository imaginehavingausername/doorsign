<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Christmas Day Sign</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Fredoka One for the bubbly shape -->
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Fredoka One', cursive;
            overflow: hidden;
            margin: 0;
            background: #000;
            touch-action: none; /* Prevent scroll on mobile */
        }

        /* --- 1. Background & Atmosphere --- */
        .global-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: -1;
            /* Deep, rich Christmas gradient */
            background: radial-gradient(circle at center, #8f1729 0%, #174227 60%, #05140b 100%);
            background-size: 200% 200%;
            animation: christmasGlow 15s ease-in-out infinite alternate;
            transition: opacity 2s ease;
        }

        @keyframes christmasGlow {
            0% { background-position: 0% 50%; filter: brightness(0.9); }
            50% { background-position: 100% 50%; filter: brightness(1.2); }
            100% { background-position: 0% 50%; filter: brightness(0.9); }
        }

        /* --- 2. Snow System --- */
        .snowflake {
            position: absolute;
            background-color: white;
            border-radius: 50%;
            pointer-events: none;
            animation: fall linear infinite;
        }

        @keyframes fall {
            0% { transform: translateY(-10vh) translateX(0); }
            100% { transform: translateY(110vh) translateX(20px); }
        }

        /* --- 3. Mylar Balloon Typography --- */
        .balloon-word {
            display: flex;
            justify-content: center;
            gap: 0.2rem; /* Tight gap for balloon clusters */
            perspective: 1000px;
        }

        .balloon-char {
            display: inline-block;
            position: relative;
            color: #d4af37; /* Fallback */
            
            /* The Mylar Material Look */
            background-image: linear-gradient(135deg, 
                #ffd700 0%, 
                #fff8db 20%, 
                #d4af37 40%, 
                #b8860b 60%, 
                #fff8db 80%, 
                #d4af37 100%
            );
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            
            /* 3D Depth & Shine */
            filter: drop-shadow(0px 4px 6px rgba(0,0,0,0.6));
            
            /* Initial State for Animation */
            transform-origin: center bottom;
            will-change: transform;
        }

        /* Red Variant for 'Christmas' */
        .balloon-red .balloon-char {
            background-image: linear-gradient(135deg, 
                #ff4d4d 0%, 
                #ffcccc 20%, 
                #cc0000 40%, 
                #990000 60%, 
                #ffcccc 80%, 
                #cc0000 100%
            );
        }

        /* Floating Animation (Bobbing) */
        @keyframes floatBalloon {
            0% { transform: translateY(0) rotate(-3deg) scale(1); }
            50% { transform: translateY(-15px) rotate(3deg) scale(1.02); }
            100% { transform: translateY(0) rotate(-3deg) scale(1); }
        }

        /* Pop-in Animation (Inflation) */
        @keyframes inflate {
            0% { transform: scale(0); opacity: 0; }
            60% { transform: scale(1.2); opacity: 1; }
            80% { transform: scale(0.9); }
            100% { transform: scale(1); opacity: 1; }
        }

        /* --- 4. Sleep Mode (Blackout) --- */
        #blackout-curtain {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: black;
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: opacity 2s ease;
        }
        .sleeping #blackout-curtain {
            opacity: 1;
            pointer-events: all;
        }
    </style>
</head>
<body class="bg-black text-white h-screen w-screen overflow-hidden flex items-center justify-center">
    
    <!-- Background Elements -->
    <div class="global-bg" id="bg-layer"></div>
    
    <!-- Snow Layer 1: Behind Text (Z-Index 0) -->
    <div id="snow-back" class="fixed top-0 left-0 w-full h-full pointer-events-none z-0"></div>
    
    <!-- Sleep Mode Overlay -->
    <div id="blackout-curtain"></div>

    <!-- Main Content (Z-Index 10) -->
    <main id="main-content" class="relative z-10 flex flex-col items-center justify-center w-full max-w-lg mx-auto p-4 space-y-8">
        
        <!-- MERRY -->
        <div id="word-merry" class="balloon-word text-[18vw] md:text-[8rem] leading-none">
            <!-- Letters injected by JS -->
        </div>

        <!-- CHRISTMAS -->
        <div id="word-christmas" class="balloon-word balloon-red text-[13vw] md:text-[6rem] leading-none">
            <!-- Letters injected by JS -->
        </div>

    </main>

    <!-- Snow Layer 2: In Front of Text (Z-Index 20) -->
    <div id="snow-front" class="fixed top-0 left-0 w-full h-full pointer-events-none z-20"></div>

    <script>
        // --- Configuration ---
        const CONFIG = {
            refreshInterval: 20000, // 20 seconds
            sleepTime: 22.5,        // 10:30 PM (22:30 = 22.5)
            wakeTime: 6.0,          // 6:00 AM
            debug: false            // Set to true to test sleep mode immediately
        };

        // --- 1. Typography Setup ---
        function createBalloonText(elementId, text) {
            const container = document.getElementById(elementId);
            container.innerHTML = '';
            
            [...text].forEach((char, index) => {
                const span = document.createElement('span');
                span.textContent = char;
                span.className = 'balloon-char';
                
                // Staggered Animation for "Float"
                // Randomize delay slightly so they don't bob in perfect unison
                const delay = Math.random() * 2;
                const duration = 3 + Math.random() * 2; // 3-5s duration
                span.style.animation = `floatBalloon ${duration}s ease-in-out infinite alternate`;
                span.style.animationDelay = `-${delay}s`;
                
                container.appendChild(span);
            });
        }

        function triggerInflation() {
            const chars = document.querySelectorAll('.balloon-char');
            chars.forEach((char, index) => {
                // Reset animation to trigger reflow
                char.style.animation = 'none';
                char.offsetHeight; /* trigger reflow */
                
                // Re-apply float, but add inflate entrance
                // We combine animations: inflate runs once, float runs infinitely
                const floatDelay = Math.random() * 2;
                const floatDuration = 3 + Math.random() * 2;
                
                // Stagger the inflation slightly for a wave effect
                const inflateDelay = index * 0.05; 
                
                char.style.animation = `
                    inflate 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) ${inflateDelay}s forwards, 
                    floatBalloon ${floatDuration}s ease-in-out ${inflateDelay + 0.8}s infinite alternate
                `;
            });
        }

        // --- 2. Snow System ---
        function createSnowLayer(containerId, count, minSize, maxSize, minOpacity, maxOpacity) {
            const container = document.getElementById(containerId);
            
            for (let i = 0; i < count; i++) {
                const flake = document.createElement('div');
                flake.classList.add('snowflake');
                
                // Random Positioning
                flake.style.left = Math.random() * 100 + 'vw';
                flake.style.top = '-10vh';
                
                // Random Appearance
                const size = Math.random() * (maxSize - minSize) + minSize;
                flake.style.width = size + 'vw';
                flake.style.height = size + 'vw';
                flake.style.opacity = Math.random() * (maxOpacity - minOpacity) + minOpacity;
                
                // Random Fall Physics
                const duration = Math.random() * 5 + 10; // 10-15s fall time
                flake.style.animationDuration = duration + 's';
                flake.style.animationDelay = (Math.random() * duration) * -1 + 's'; // Start randomly
                
                container.appendChild(flake);
            }
        }

        function initSnow() {
            // Back Snow: Smaller, dimmer, behind text
            createSnowLayer('snow-back', 30, 0.2, 0.5, 0.1, 0.4);
            
            // Front Snow: Larger, brighter, in front of text
            createSnowLayer('snow-front', 20, 0.6, 1.2, 0.5, 0.9);
        }

        // --- 3. Animation Cycle Logic ---
        function startAnimationCycle() {
            // Initial state: Text inflates
            triggerInflation();

            setInterval(() => {
                // If sleeping, do not run animation logic
                if (document.body.classList.contains('sleeping')) return;

                // Just re-trigger the inflation animation
                triggerInflation();

            }, CONFIG.refreshInterval);
        }

        // --- 4. Sleep Timer Logic ---
        function checkTime() {
            const now = new Date();
            const currentHour = now.getHours() + (now.getMinutes() / 60);
            
            // Sleep Condition: After 10:30 PM OR Before 6:00 AM
            // 22:30 = 22.5
            const isSleepTime = currentHour >= CONFIG.sleepTime || currentHour < CONFIG.wakeTime;

            if (isSleepTime && !CONFIG.debug) {
                if (!document.body.classList.contains('sleeping')) {
                    console.log("Goodnight! Entering sleep mode.");
                    document.body.classList.add('sleeping');
                }
            } else {
                if (document.body.classList.contains('sleeping')) {
                    console.log("Good morning! Waking up.");
                    document.body.classList.remove('sleeping');
                    // Re-trigger animation on wake
                    triggerInflation();
                }
            }
        }

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            // Setup Text
            createBalloonText('word-merry', 'MERRY');
            createBalloonText('word-christmas', 'CHRISTMAS');
            
            // Setup Environment
            initSnow();
            
            // Start Cycles
            startAnimationCycle();
            
            // Start Sleep Timer (Check every minute)
            checkTime();
            setInterval(checkTime, 60000);
        });

    </script>
</body>
</html>
