<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Door Sign</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Inter for UI text, JetBrains Mono for the numbers (tabular figures needed for timer) -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;800&family=JetBrains+Mono:wght@700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            overflow: hidden;
            margin: 0;
            background: #000;
        }

        /* --- Background --- */
        .global-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: -1;
            /* Restored the festive Red/Green gradient */
            background: radial-gradient(ellipse at bottom, #C41E3A 0%, #165B33 50%, #000000 100%);
            background-size: 200% 200%;
            animation: christmasGlow 15s ease-in-out infinite alternate;
        }

        @keyframes christmasGlow {
            0% { background-position: 0% 80%; filter: brightness(0.8); }
            50% { background-position: 100% 20%; filter: brightness(1.1); }
            100% { background-position: 0% 80%; filter: brightness(0.8); }
        }

        /* --- Slider Animation --- */
        #slider-wrapper {
            position: relative;
            width: 100vw;
            height: 200vh;
            /* 10s loop: 4.5s hold, 0.5s slide */
            animation: slideScreens 10s cubic-bezier(0.76, 0, 0.24, 1) infinite;
            will-change: transform, filter;
        }

        @keyframes slideScreens {
            0%, 45% { transform: translateY(0); filter: blur(0px); }
            46%, 49% { filter: blur(8px); } /* Motion blur */
            50%, 95% { transform: translateY(-100vh); filter: blur(0px); }
            96%, 99% { filter: blur(8px); } /* Motion blur return */
            100% { transform: translateY(0); filter: blur(0px); }
        }

        /* --- Screens --- */
        .screen {
            position: absolute;
            left: 0;
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            color: #fff;
            z-index: 10;
        }

        #message-screen { top: 0; }
        #christmas-screen { top: 100vh; }

        /* --- Snowflakes --- */
        .snowflake {
            position: absolute;
            background-color: white;
            border-radius: 50%;
            opacity: 0.8;
            pointer-events: none;
            z-index: 5;
            animation: fall linear infinite;
        }

        @keyframes fall {
            0% { transform: translateY(0); }
            100% { transform: translateY(210vh); } /* Fall slightly past the 200vh container */
        }

        /* --- Timer Styling --- */
        .timer-font {
            font-family: 'JetBrains Mono', monospace;
            font-variant-numeric: tabular-nums;
        }
        
        /* Glassmorphism Card */
        .glass-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
        }

        /* Gradient Text */
        .gradient-text {
            background: linear-gradient(to bottom, #ffffff, #a5a5a5);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            filter: drop-shadow(0px 2px 4px rgba(0,0,0,0.5));
        }

        /* Separator Dots Animation */
        .separator-dot {
            animation: blink 1s ease-in-out infinite;
        }
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        /* Progress/Glow Ring effect for seconds */
        .glow-ring {
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.1);
            transition: box-shadow 0.2s ease;
        }
    </style>
</head>
<body class="bg-black text-white">
    
    <div class="global-bg"></div>

    <div id="content-wrapper">
        <div id="slider-wrapper">
            <!-- Snow is injected here -->

            <!-- Screen 1: Message -->
            <div id="message-screen" class="screen px-4">
                <!-- Content loaded from message.html -->
                <div class="animate-pulse">Loading message...</div>
            </div>

            <!-- Screen 2: Christmas Countdown -->
            <div id="christmas-screen" class="screen">
                <div class="relative z-10 flex flex-col items-center justify-center w-full">
                    
                    <div class="text-[3vw] font-bold uppercase tracking-[0.2em] text-green-400 mb-8 drop-shadow-lg">
                        Christmas is in
                    </div>

                    <!-- Timer Container -->
                    <div class="flex items-center justify-center gap-2 md:gap-4">
                        
                        <!-- HOURS -->
                        <div class="glass-card flex flex-col items-center justify-center p-6 rounded-2xl w-[28vw] md:w-48 aspect-square relative overflow-hidden group">
                            <div class="absolute inset-0 bg-gradient-to-b from-transparent to-green-900/20 opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                            <!-- Added Progress Bar for Hours -->
                            <div id="hour-bar" class="absolute bottom-0 left-0 h-1 bg-white/30 transition-all duration-300 ease-out" style="width: 0%"></div>
                            
                            <span id="hours" class="timer-font gradient-text text-[8vw] md:text-7xl font-bold leading-none">00</span>
                            <span class="text-[1.5vw] md:text-sm uppercase tracking-widest text-gray-400 mt-2">Hours</span>
                        </div>

                        <!-- Separator -->
                        <div class="flex flex-col gap-2 md:gap-4 text-2xl md:text-4xl text-gray-500">
                            <span class="separator-dot">●</span>
                            <span class="separator-dot">●</span>
                        </div>

                        <!-- MINUTES -->
                        <div class="glass-card flex flex-col items-center justify-center p-6 rounded-2xl w-[28vw] md:w-48 aspect-square relative overflow-hidden">
                            <!-- Added Progress Bar for Minutes -->
                            <div id="min-bar" class="absolute bottom-0 left-0 h-1 bg-white/50 transition-all duration-300 ease-out" style="width: 0%"></div>

                            <span id="minutes" class="timer-font gradient-text text-[8vw] md:text-7xl font-bold leading-none">00</span>
                            <span class="text-[1.5vw] md:text-sm uppercase tracking-widest text-gray-400 mt-2">Minutes</span>
                        </div>

                        <!-- Separator -->
                        <div class="flex flex-col gap-2 md:gap-4 text-2xl md:text-4xl text-gray-500">
                            <span class="separator-dot">●</span>
                            <span class="separator-dot">●</span>
                        </div>

                        <!-- SECONDS -->
                        <div class="glass-card glow-ring flex flex-col items-center justify-center p-6 rounded-2xl w-[28vw] md:w-48 aspect-square relative overflow-hidden">
                            <!-- Subtle progress bar at bottom -->
                            <div id="sec-bar" class="absolute bottom-0 left-0 h-1 bg-green-500 transition-all duration-300 ease-out" style="width: 100%"></div>
                            
                            <span id="seconds" class="timer-font text-white text-[8vw] md:text-7xl font-bold leading-none drop-shadow-[0_0_10px_rgba(255,255,255,0.5)]">00</span>
                            <span class="text-[1.5vw] md:text-sm uppercase tracking-widest text-green-400 mt-2">Seconds</span>
                        </div>

                    </div>
                </div>
            </div>

        </div> 
    </div>

    <script>
        const messageScreen = document.getElementById('message-screen');
        const sliderWrapper = document.getElementById('slider-wrapper');
        let countdownInterval;

        // --- Snow Generation ---
        function createSnow() {
            const snowflakeCount = 60; 
            for (let i = 0; i < snowflakeCount; i++) {
                const flake = document.createElement('div');
                flake.classList.add('snowflake');
                
                // Randomize horizontal position
                flake.style.left = Math.random() * 100 + 'vw';
                
                // FIX: Start ALL snow above the container. 
                // The random distribution comes from animation-delay, not start position.
                // -10vh ensures it spawns out of sight.
                flake.style.top = '-10vh';
                
                const size = Math.random() * 0.4 + 0.2; 
                flake.style.width = size + 'vw';
                flake.style.height = size + 'vw';
                
                const duration = Math.random() * 5 + 8; // 8-13s fall duration
                flake.style.animationDuration = duration + 's';
                
                // Negative delay makes them start "already falling" so no initial empty screen
                // We use a large range to ensure they are well distributed vertically
                flake.style.animationDelay = (Math.random() * duration) * -1 + 's';
                
                flake.style.opacity = Math.random() * 0.5 + 0.1;
                sliderWrapper.appendChild(flake);
            }
        }

        // --- Message Loader ---
        async function loadMessage() {
            try {
                // Ensure we use a cache buster to get the latest message immediately
                const response = await fetch('message.html?t=' + new Date().getTime());
                if (!response.ok) throw new Error('Network response was not ok');
                const html = await response.text();
                // Only update if content is different to prevent flash
                if (messageScreen.innerHTML !== html) {
                    messageScreen.innerHTML = html;
                }
            } catch (error) {
                console.error('Failed to fetch message:', error);
                if(messageScreen.innerHTML.trim() === "" || messageScreen.innerHTML.includes("Loading")) {
                     messageScreen.innerHTML = `<div class="flex flex-col text-center"><h1 class="text-4xl font-bold text-white">Happy Holidays!</h1></div>`;
                }
            }
        }

        // --- Countdown Logic ---
        function startCountdown() {
            if (countdownInterval) clearInterval(countdownInterval);

            const hoursEl = document.getElementById('hours');
            const minutesEl = document.getElementById('minutes');
            const secondsEl = document.getElementById('seconds');
            
            const hourBar = document.getElementById('hour-bar');
            const minBar = document.getElementById('min-bar');
            const secBar = document.getElementById('sec-bar');

            const update = () => {
                const now = new Date();
                let christmasDate = new Date(`December 25, ${now.getFullYear()} 00:00:00`);
                
                // If Christmas passed this year, count to next year
                if (now > christmasDate) {
                    christmasDate = new Date(`December 25, ${now.getFullYear() + 1} 00:00:00`);
                }

                const totalSeconds = Math.floor((christmasDate - now) / 1000);

                // Calculate TOTAL hours (days * 24 + hours)
                const totalHours = Math.floor(totalSeconds / 3600);
                const minutes = Math.floor((totalSeconds % 3600) / 60);
                const seconds = totalSeconds % 60;

                // Update DOM
                hoursEl.innerText = totalHours; 
                minutesEl.innerText = String(minutes).padStart(2, '0');
                secondsEl.innerText = String(seconds).padStart(2, '0');

                // Visual Flair: Bars
                
                // Seconds: 0-60
                const secPct = (seconds / 60) * 100;
                if(secBar) secBar.style.width = `${secPct}%`;

                // Minutes: 0-60
                const minPct = (minutes / 60) * 100;
                if(minBar) minBar.style.width = `${minPct}%`;

                // Hours: Modulo 24 (progress through a "day" unit)
                const hourPct = ((totalHours % 24) / 24) * 100;
                if(hourBar) hourBar.style.width = `${hourPct}%`;
            };

            update();
            countdownInterval = setInterval(update, 1000);
        }

        // --- Init ---
        createSnow();
        loadMessage();
        setInterval(loadMessage, 5000); // Check for new message every 5s
        startCountdown();
        
        // Sleep cycle removed as requested!
    </script>
</body>
</html>
