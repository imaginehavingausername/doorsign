<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Door Sign</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden; /* This is key to hiding the sliding content */
            margin: 0;
            
            /* --- NEW: Christmas background is now permanently on the body --- */
            background: radial-gradient(ellipse at bottom, #C41E3A 0%, #165B33 50%, #FFFFFF 100%);
            background-size: 200% 200%;
            animation: christmasGlow 15s ease-in-out infinite alternate;
        }

        /* --- Keyframes for the background animation --- */
        @keyframes christmasGlow {
          0% { background-position: 0% 80%; }
          50% { background-position: 100% 20%; }
          100% { background-position: 0% 80%; }
        }

        /* --- NEW: Wrapper for the sliding animation --- */
        #slider-wrapper {
            position: relative;
            width: 100vw;
            height: 200vh; /* 2x viewport height to hold both screens */
            /* Animation: 10s total duration
               - 4.5s hold on screen 1
               - 0.5s slide
               - 4.5s hold on screen 2
               - 0.5s slide back
            */
            animation: slideScreens 10s cubic-bezier(0.76, 0, 0.24, 1) infinite;
        }

        /* --- Keyframes for the sliding animation --- */
        @keyframes slideScreens {
            0% {
                transform: translateY(0);
            }
            45% {
                transform: translateY(0); /* Hold message screen */
            }
            50% {
                transform: translateY(-100vh); /* Slide up */
            }
            95% {
                transform: translateY(-100vh); /* Hold christmas screen */
            }
            100% {
                transform: translateY(0); /* Slide down */
            }
        }

        /* --- Screen containers --- */
        .screen {
            position: absolute;
            left: 0;
            width: 100vw;
            height: 100vh; /* Each screen is full viewport height */
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            color: #f0f0f0;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.7);
        }

        /* --- Original Message Screen Styling --- */
        #message-screen {
            top: 0; /* Sits at the top of the slider */
            /* Removed old background */
        }
        
        /* --- Christmas Screen Styling --- */
        #christmas-screen {
            top: 100vh; /* Sits below the first screen in the slider */
            /* Removed old background */
        }
        
        /* --- Simple class to hide the content wrapper --- */
        .content-hidden {
            display: none;
        }
    </style>
</head>
<body class="bg-black"> <!-- bg-black is a fallback -->
    
    <!-- A wrapper around all content that can be hidden during sleep time -->
    <div id="content-wrapper">

        <!-- NEW: This wrapper will contain both screens and animate vertically -->
        <div id="slider-wrapper">

            <!-- Screen for the main message - content is loaded dynamically -->
            <div id="message-screen" class="screen">
                <!-- Loading message content... -->
            </div>

            <!-- Screen for the Christmas Countdown -->
            <div id="christmas-screen" class="screen">
                <div class="text-center">
                    <div class="text-[5vw] md:text-[4vw] font-bold uppercase tracking-wider opacity-90 mb-4">Christmas In</div>
                    <div class="flex justify-center gap-4 md:gap-8">
                        <div class="flex flex-col items-center bg-black/20 p-2 md:p-4 rounded-lg min-w-[18vw] md:min-w-[120px] border border-white/10">
                            <span id="days" class="text-[12vw] md:text-8xl font-bold leading-none">0</span>
                            <span class="text-[2.5vw] md:text-xl uppercase opacity-70 font-normal">Days</span>
                        </div>
                        <div class="flex flex-col items-center bg-black/20 p-2 md:p-4 rounded-lg min-w-[18vw] md:min-w-[120px] border border-white/10">
                            <span id="hours" class="text-[12vw] md:text-8xl font-bold leading-none">0</span>
                            <span class="text-[2.5vw] md:text-xl uppercase opacity-70 font-normal">Hours</span>
                        </div>
                        <div class="flex flex-col items-center bg-black/20 p-2 md:p-4 rounded-lg min-w-[18vw] md:min-w-[120px] border border-white/10">
                            <span id="minutes" class="text-[12vw] md:text-8xl font-bold leading-none">0</span>
                            <span class="text-[2.5vw] md:text-xl uppercase opacity-70 font-normal">Mins</span>
                        </div>
                        <div class="flex flex-col items-center bg-black/20 p-2 md:p-4 rounded-lg min-w-[18vw] md:min-w-[120px] border border-white/10">
                            <span id="seconds" class="text-[12vw] md:text-8xl font-bold leading-none">0</span>
                            <span class="text-[2.5vw] md:text-xl uppercase opacity-70 font-normal">Secs</span>
                        </div>
                    </div>
                </div>
            </div>

        </div> <!-- end #slider-wrapper -->

    </div> <!-- end #content-wrapper -->

    <script>
        const contentWrapper = document.getElementById('content-wrapper');
        const messageScreen = document.getElementById('message-screen');
        // const christmasScreen = document.getElementById('christmas-screen'); // No longer needed for JS
        let countdownInterval;
        let wakeUpFlag = true; // Flag to manage the morning message change

        // --- Function to load message from external file ---
        async function loadMessage() {
            try {
                // Add a timestamp to the URL to prevent the browser from caching the file
                const response = await fetch('message.html?t=' + new Date().getTime());
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                const html = await response.text();
                // Only update the message if we are not in the special "asleep" state
                if (!wakeUpFlag) { 
                    messageScreen.innerHTML = html;
                }
            } catch (error) {
                console.error('Failed to fetch message:', error);
                messageScreen.innerHTML = `<div class="text-center">Could not load message.</div>`;
            }
        }

        // --- Countdown logic ---
        function startCountdown() {
            if (countdownInterval) clearInterval(countdownInterval);

            const daysEl = document.getElementById('days');
            const hoursEl = document.getElementById('hours');
            const minutesEl = document.getElementById('minutes');
            const secondsEl = document.getElementById('seconds');

            const update = () => {
                const now = new Date();
                let christmasDate = new Date(`December 25, ${now.getFullYear()} 00:00:00`);
                if (now > christmasDate) {
                    christmasDate = new Date(`December 25, ${now.getFullYear() + 1} 00:00:00`);
                }
                const totalSeconds = Math.floor((christmasDate - now) / 1000);

                daysEl.innerText = Math.floor(totalSeconds / 86400);
                hoursEl.innerText = String(Math.floor((totalSeconds % 86400) / 3600)).padStart(2, '0');
                minutesEl.innerText = String(Math.floor((totalSeconds % 3600) / 60)).padStart(2, '0');
                secondsEl.innerText = String(totalSeconds % 60).padStart(2, '0');
            };

            update();
            countdownInterval = setInterval(update, 1000);
        }

        // --- Screen cycling logic ---
        // REMOVED: This is now handled entirely by CSS animations on #slider-wrapper

        // --- Function to manage the sleep/wake cycle and morning message ---
        function manageSleepCycle() {
            const now = new Date();
            const hour = now.getHours();
            const minute = now.getMinutes();

            // Screen is off between 10:45 PM (22:45) and 6:00 AM (06:00)
            const isSleepTime = (hour > 22 || (hour === 22 && minute >= 45)) || (hour < 6);

            if (isSleepTime) {
                // Hide the content to make the screen appear black.
                if (!contentWrapper.classList.contains('content-hidden')) {
                    contentWrapper.classList.add('content-hidden');
                }
                // Set the flag to true, indicating the next transition to awake should trigger the message change.
                wakeUpFlag = true;
            } else {
                // It's time to be awake. Show the content.
                if (contentWrapper.classList.contains('content-hidden')) {
                    contentWrapper.classList.remove('content-hidden');
                }

                // If the wakeUpFlag is true, it means we just transitioned from sleep to awake.
                if (wakeUpFlag) {
                    console.log("Good morning! Setting message to 'asleep'.");
                    // Manually set the message content to "asleep"
                    messageScreen.innerHTML = `
                    <div class="flex flex-col text-center max-w-[90%]">
                        <div class="text-[10vw] font-extrabold uppercase text-gray-100 leading-tight">asleep</div>
                    </div>`;
                    // Set the flag to false so this only runs once per wake-up.
                    // The regular `loadMessage` function will now be able to update the content.
                    wakeUpFlag = false; 
                }
            }
        }

        // --- Start everything ---
        loadMessage(); // Load the message initially
        setInterval(loadMessage, 10000); // Check for a new message every 10 seconds

        startCountdown();
        // cycleScreens(); // No longer needed

        // --- Start the sleep cycle manager ---
        manageSleepCycle(); // Run once on page load to set the correct initial state
        setInterval(manageSleepCycle, 60000); // Check the time every minute
    </script>
</body>
</html>
